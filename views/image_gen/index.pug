//- views/image_gen/index.pug
extends ../layout

block styles
  style.
    .muted{color:#6c757d}
    .thumb{border:1px solid #dee2e6;border-radius:.5rem;padding:.5rem;background:#0d0f14}
    .thumb img{max-width:100%;height:auto;border-radius:.25rem}
    .monospace{font-family:ui-monospace,SFMono-Regular,Menlo,monospace}
    .log{background:#0b0d12;color:#e9ecef;border:1px solid #1f232b;border-radius:.5rem;padding:.75rem;max-height:200px;overflow:auto}
    .pill{display:inline-block;padding:.15rem .5rem;border-radius:50rem;background:#0d1220;border:1px solid #2a2f3a;font-size:.8rem;margin-left:.25rem}

block content
  .container.py-3
    .d-flex.align-items-center.mb-3
      h1.h4.mb-0 ComfyUI â€“ Image Generation
      span#statusPill.pill.ms-2 idle

    // Settings (optional health)
    .card.mb-3
      .card-body
        .d-flex.align-items-center.gap-2
          button#btnHealth.btn.btn-outline-secondary.btn-sm(type="button") Health
          span#healthDot.badge.bg-secondary unknown

    // Workflows
    .card.mb-3
      .card-body
        .d-flex.justify-content-between.align-items-center.mb-2
          h2.h6.mb-0 Workflows
          button#btnLoadWf.btn.btn-primary.btn-sm(type="button") Load
        .row.g-3.align-items-end
          .col-md-6
            label.form-label(for="wfSelect") Select workflow
            select#wfSelect.form-select
          .col-md-6
            small#wfCount.text-muted 0 loaded
        .mt-2
          small#wfDesc.text-muted
        hr
        form#genForm
          .row.g-3#formArea
          .d-flex.gap-2.mt-3
            button#btnExample1.btn.btn-outline-secondary(type="button") Insert example prompt
            button#btnGenerate.btn.btn-success(type="button") Generate

    // Upload & browse
    .card.mb-3
      .card-body
        h2.h6 Upload & Browse
        .row.g-3
          .col-md-6
            label.form-label(for="fileUp") Upload image to input/
            input#fileUp.form-control(type="file" accept="image/*")
            .d-flex.gap-2.mt-2
              button#btnUpload.btn.btn-outline-primary(type="button") Upload
              small#lastUpload.muted
          .col-md-6
            label.form-label Browse
            .d-flex.gap-2
              button#btnListInput.btn.btn-outline-secondary(type="button") List input
              button#btnListOutput.btn.btn-outline-secondary(type="button") List output
        .row.row-cols-2.row-cols-md-4.g-3.mt-2#browseArea

    // Jobs
    .card.mb-3
      .card-body
        h2.h6 Job
        .row.g-3.align-items-end
          .col-md-6
            label.form-label(for="jobId") Job ID
            input#jobId.form-control(type="text" readonly)
          .col-md-6
            .d-flex.align-items-center.gap-2
              button#btnPoll.btn.btn-outline-secondary(type="button") Poll
              span#jobStatus.badge.bg-secondary -
        .row.row-cols-2.row-cols-md-3.g-3.mt-2#results

    // Log
    .card
      .card-body
        h2.h6 Log
        .log#log

block script
  //- Serve this file from /public/js/image_gen.js
  script(src="/js/image_gen.js")