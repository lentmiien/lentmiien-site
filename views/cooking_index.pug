extends layout

block styles
  link(rel='stylesheet', href='https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css')

block content
  .cooking-calendar-page
    .cooking-calendar-header.d-flex.flex-wrap.align-items-center.justify-content-between.mb-3.gap-3
      h2.mb-0 Cooking calendar - version 2
      .d-flex.gap-2.flex-wrap
        a.btn.btn-outline-secondary(href='/cooking') View legacy calendar
        a.btn.btn-primary(href='/cooking/v2/statistics') View statistics
    .card.calendar-shell.border-0.shadow-sm.mb-4
      .card-body
        .calendar-controls
          .btn-group
            button#prevWeek.btn.btn-outline-secondary(type='button')
              i.bi.bi-chevron-left
              |  Previous
            button#nextWeek.btn.btn-outline-secondary(type='button')
              | Next
              i.bi.bi-chevron-right.ms-2
          .flex-grow-1
            label.form-label(for='weekStart') Week starting
            input#weekStart.form-control(type='date', value=initialDate)
          button#reloadCalendar.btn.btn-outline-primary(type='button') Refresh
    #calendarDays.row.g-4.calendar-days
      .col-12
        .calendar-loading.text-center.text-muted.py-5 Loading calendar...

  // Recipe selection modal
  .modal.fade#recipeModal(tabindex='-1', aria-hidden='true')
    .modal-dialog.modal-dialog-centered.modal-xl
      .modal-content
        .modal-header
          h5.modal-title Select a recipe
          button.btn-close(type='button' data-bs-dismiss='modal' aria-label='Close')
        .modal-body
          p.text-muted#selectedDateLabel.mb-3 Schedule a recipe
          form.row.g-3.mb-3
            .col-12.col-lg-4
              label.form-label(for='categorySelect') Category
              select#categorySelect.form-select
            .col-12.col-lg-4
              label.form-label(for='customCategory') Custom category
              input#customCategory.form-control(type='text' placeholder='Optional - override category')
            .col-12.col-lg-4
              label.form-label(for='recipeSearch') Search recipes
              input#recipeSearch.form-control(type='search' placeholder='Search by name')
          #recentWarning.alert.alert-warning.d-none(role='alert') Recently cooked warning
          .recipe-list.list-group
          .recipe-modal-footer.mt-3.d-flex.justify-content-between.align-items-center
            small.text-muted#recipeCount 0 recipes
            button#scheduleRecipe.btn.btn-primary(type='button' disabled) Schedule recipe
    .modal-footer
      button.btn.btn-outline-secondary(type='button' data-bs-dismiss='modal') Cancel
  // Toast container for feedback
  .toast-container.position-fixed.bottom-0.end-0.p-3(style='z-index: 1080;')
    .toast.align-items-center.text-white.bg-success.border-0(role='status' aria-live='polite' aria-atomic='true')
      .d-flex
        .toast-body#toastMessage Action completed
        button.btn-close.btn-close-white.me-2.m-auto(type='button' data-bs-dismiss='toast' aria-label='Close')

block script
  script.
    window.COOKING_CALENDAR_V2 = {
      initialDate: '#{initialDate}',
      categories: !{JSON.stringify(categories)},
    };
  script(src='/cooking_index.js', defer)
